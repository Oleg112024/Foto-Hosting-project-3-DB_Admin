<!-- 
============================================================================
–®–ê–ë–õ–û–ù –°–ü–ò–°–ö–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø - –ü–ï–†–°–û–ù–ê–õ–¨–ù–ê–Ø –ì–ê–õ–ï–†–ï–Ø
============================================================================

–≠—Ç–æ—Ç —à–∞–±–ª–æ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –≥–∞–ª–µ—Ä–µ—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–≤ —Ç–∞–±–ª–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç
–ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ –∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- –¢–∞–±–ª–∏—á–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤ (–∏–º—è, –¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏, —Å—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è)
- –î–µ–π—Å—Ç–≤–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–ø—Ä–æ—Å–º–æ—Ç—Ä, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏, —É–¥–∞–ª–µ–Ω–∏–µ)
- –°–∏—Å—Ç–µ–º–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
- JavaScript —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –°–æ—Å—Ç–æ—è–Ω–∏–µ "–ø—É—Å—Ç–æ–π –≥–∞–ª–µ—Ä–µ–∏" —Å –ø—Ä–∏–∑—ã–≤–æ–º –∫ –¥–µ–π—Å—Ç–≤–∏—é

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ù–∞—Å–ª–µ–¥—É–µ—Ç –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Bootstrap Table –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- Jinja2 —Ü–∏–∫–ª—ã –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- Responsive –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- Clipboard API –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ JavaScript confirm

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç:
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ—Å–Ω–æ–≤–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º
- –í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–µ–≤—å—é –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ß–µ—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ä–æ–∫–∞—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π:
- –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã images –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Flask pagination –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ URL –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ URL
- –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏:
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–æ–∫ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ä–æ–∫–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

============================================================================
-->

<!-- –ù–∞—Å–ª–µ–¥—É–µ–º –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω —Å –æ–±—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π -->
{% extends 'base.html' %}

<!-- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–ø–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
{% block title %}–°–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - –§–æ—Ç–æ –•–æ—Å—Ç–∏–Ω–≥{% endblock %}

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–ø–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
{% block content %}
<!-- ========================================================================
     –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† –°–ü–ò–°–ö–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô
     ======================================================================== -->
<div class="container mt-4">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –≥–∞–ª–µ—Ä–µ–∏ -->
    <h2 class="mb-4">–í–∞—à–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h2>
    
    <!-- ====================================================================
         FLASH-–°–û–û–ë–©–ï–ù–ò–Ø –î–õ–Ø –°–¢–†–ê–ù–ò–¶–´ –°–ü–ò–°–ö–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô
         ==================================================================== -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ 'danger' if category == 'error' else ('warning' if category == 'warning' else ('info' if category == 'info' else 'success')) }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    
    <!-- ====================================================================
         –£–°–õ–û–í–ù–û–ï –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï: –¢–ê–ë–õ–ò–¶–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô –ò–õ–ò –ü–£–°–¢–û–ï –°–û–°–¢–û–Ø–ù–ò–ï
         ==================================================================== -->
    {% if images %}
    <!-- ================================================================
         –ü–ê–ù–ï–õ–¨ –ì–†–£–ü–ü–û–í–û–ì–û –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø–ú–ò
         –ö–Ω–æ–ø–∫–∏ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
         ================================================================ -->
    <div class="mb-3" id="bulkActions" style="display: none;">
        <div class="alert alert-info d-flex justify-content-between align-items-center">
            <span id="selectedCount">–í—ã–±—Ä–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 0</span>
            <div>
                <button type="button" class="btn btn-sm btn-outline-success me-2" 
                        id="downloadSelected" disabled>
                    üì• –°–∫–∞—á–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                </button>
                <button type="button" class="btn btn-sm btn-outline-info me-2" 
                        id="shareSelected" disabled>
                    üîó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π
                </button>
                <button type="button" class="btn btn-sm btn-outline-danger me-2" 
                        id="deleteSelected" disabled>
                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                </button>
                <button type="button" class="btn btn-sm btn-outline-secondary" 
                        id="clearSelection">
                    –û—Ç–º–µ–Ω–∏—Ç—å –≤—ã–±–æ—Ä
                </button>
            </div>
        </div>
    </div>
    
    <!-- ================================================================
         RESPONSIVE –¢–ê–ë–õ–ò–¶–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô
         –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
         ================================================================ -->
    <div class="table-responsive">
        <table class="table table-hover">
            <!-- ========================================================
                 –ó–ê–ì–û–õ–û–í–û–ö –¢–ê–ë–õ–ò–¶–´
                 –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                 ======================================================== -->
            <thead class="table-light">
                <tr>
                    <th>
                        <input type="checkbox" id="selectAll" class="form-check-input">
                        <label for="selectAll" class="form-check-label ms-1">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</label>
                    </th>
                    <th>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>      <!-- –ú–∏–Ω–∏–∞—Ç—é—Ä–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
                    <th>–ò–º—è —Ñ–∞–π–ª–∞</th>        <!-- –°–∏—Å—Ç–µ–º–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ -->
                    <th>–†–∞–∑–º–µ—Ä</th>           <!-- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ KB -->
                    <th>–¢–∏–ø</th>              <!-- MIME-—Ç–∏–ø —Ñ–∞–π–ª–∞ -->
                    <th>–î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏</th>    <!-- –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è -->
                    <th>–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è</th>    <!-- –î–∞—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è -->
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>         <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–º -->
                </tr>
            </thead>
            
            <!-- ========================================================
                 –¢–ï–õ–û –¢–ê–ë–õ–ò–¶–´: –°–ü–ò–°–û–ö –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
                 –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Jinja2 —Ü–∏–∫–ª
                 ======================================================== -->
            <tbody>
                {% for image in images %}
                <tr>
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –ß–ï–ö–ë–û–ö–° –î–õ–Ø –í–´–ë–û–†–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø
                         –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
                         ============================================ -->
                    <td>
                        <input type="checkbox" class="form-check-input image-checkbox" 
                               value="{{ image[0] }}" 
                               data-filename="{{ image[1] }}">
                    </td>
                    
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –ú–ò–ù–ò–ê–¢–Æ–†–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø
                         –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –ø—Ä–µ–≤—å—é –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                         ============================================ -->
                    <td>
                        <!-- –ú–∏–Ω–∏–∞—Ç—é—Ä–∞ —Å –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º -->
                        <img src="{{ url_for('get_image', user_email=session.user_email, filename=image[1]) }}" 
                             alt="{{ image[1] }}" 
                             style="max-height: 50px; max-width: 100px; cursor: pointer;" 
                             class="image-thumbnail" 
                             data-bs-toggle="modal" 
                             data-bs-target="#imageModal" 
                             data-image-url="{{ url_for('get_image', user_email=session.user_email, filename=image[1]) }}" 
                             data-image-name="{{ image[1] }}" 
                             data-image-size="{{ (image[3] / 1024) | round(2) }} KB" 
                             data-image-type="{{ image[5] }}">
                    </td>
                    
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –ò–ú–Ø –§–ê–ô–õ–ê
                         –°–∏—Å—Ç–µ–º–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ (–æ–±—ã—á–Ω–æ UUID-based)
                         ============================================ -->
                    <td>{{ image[1] }}</td>
                    
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –†–ê–ó–ú–ï–† –§–ê–ô–õ–ê
                         –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –∫–∏–ª–æ–±–∞–π—Ç–∞—Ö —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º
                         ============================================ -->
                    <td>{{ (image[3] / 1024) | round(2) }} KB</td>
                    
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –¢–ò–ü –§–ê–ô–õ–ê
                         MIME-—Ç–∏–ø –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                         ============================================ -->
                    <td>{{ image[5] }}</td>
                    
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –î–ê–¢–ê –ó–ê–ì–†–£–ó–ö–ò
                         –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
                         ============================================ -->
                    <td>{{ image[4] }}</td>
                    
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –°–†–û–ö –•–†–ê–ù–ï–ù–ò–Ø
                         –î–∞—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞
                         ============================================ -->
                    <td>{{ image[7] }}</td>
                    
                    <!-- ============================================
                         –ö–û–õ–û–ù–ö–ê: –î–ï–ô–°–¢–í–ò–Ø –° –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï–ú
                         –ì—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–º
                         ============================================ -->
                    <td>
                        <div class="btn-group" role="group">
                            <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ -->
                            <a href="{{ url_for('view_image', user_email=session.user_email, filename=image[1]) }}" 
                               class="btn btn-sm btn-primary" 
                               target="_blank">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                            
                            <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ -->
                            <a href="{{ url_for('download_image', user_email=session.user_email, filename=image[1]) }}" 
                               class="btn btn-sm btn-success" 
                               download>–°–∫–∞—á–∞—Ç—å</a>
                            
                            <!-- –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–∏ -->
                            <button class="btn btn-sm btn-outline-primary copy-btn" 
                                    data-url="{{ url_for('get_image', user_email=session.user_email, filename=image[1], _external=True) }}">
                                –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                            </button>
                            
                            <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º -->
                            <a href="{{ url_for('delete_image_route', id=image[0]) }}" 
                               class="btn btn-sm btn-danger" 
                               onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ?')">
                                –£–¥–∞–ª–∏—Ç—å
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- ================================================================
         –°–ò–°–¢–ï–ú–ê –ü–ê–ì–ò–ù–ê–¶–ò–ò –î–õ–Ø –ë–û–õ–¨–®–ò–• –ö–û–õ–õ–ï–ö–¶–ò–ô
         –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
         ================================================================ -->
    {% if total_pages > 1 %}
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <!-- ================================================
                 –ö–ù–û–ü–ö–ê "–ü–†–ï–î–´–î–£–©–ê–Ø –°–¢–†–ê–ù–ò–¶–ê"
                 –ê–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –Ω–∞ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                 ================================================ -->
            {% if page > 1 %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('images_list', page=page-1) }}">
                    &laquo; –ü—Ä–µ–¥—ã–¥—É—â–∞—è
                </a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">&laquo; –ü—Ä–µ–¥—ã–¥—É—â–∞—è</span>
            </li>
            {% endif %}
            
            <!-- ================================================
                 –ù–û–ú–ï–†–ê –°–¢–†–ê–ù–ò–¶
                 –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ total_pages
                 ================================================ -->
            {% for i in range(1, total_pages + 1) %}
            <li class="page-item {% if i == page %}active{% endif %}">
                <a class="page-link" href="{{ url_for('images_list', page=i) }}">{{ i }}</a>
            </li>
            {% endfor %}
            
            <!-- ================================================
                 –ö–ù–û–ü–ö–ê "–°–õ–ï–î–£–Æ–©–ê–Ø –°–¢–†–ê–ù–ò–¶–ê"
                 –ê–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                 ================================================ -->
            {% if page < total_pages %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('images_list', page=page+1) }}">
                    –°–ª–µ–¥—É—é—â–∞—è &raquo;
                </a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">–°–ª–µ–¥—É—é—â–∞—è &raquo;</span>
            </li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}
    
    {% else %}
    <!-- ================================================================
         –°–û–°–¢–û–Ø–ù–ò–ï "–ü–£–°–¢–ê–Ø –ì–ê–õ–ï–†–ï–Ø"
         –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
         ================================================================ -->
    <div class="alert alert-info">
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.</p>
        <!-- –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é: –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
        <a href="{{ url_for('upload_file') }}" class="btn btn-primary">
            –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        </a>
    </div>
    {% endif %}
</div>

<!-- ========================================================================
     –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ü–†–û–°–ú–û–¢–†–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô
     –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
     ======================================================================== -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="imageModalLabel">–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
            </div>
            <div class="modal-body text-center">
                <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ -->
                <img id="modalImage" src="" alt="" class="img-fluid mb-3" style="max-height: 70vh;">
                
                <!-- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                <div class="row">
                    <div class="col-md-3">
                        <strong>–ò–º—è —Ñ–∞–π–ª–∞:</strong><br>
                        <span id="modalImageName"></span>
                    </div>
                    <div class="col-md-3">
                        <strong>–†–∞–∑–º–µ—Ä:</strong><br>
                        <span id="modalImageSize"></span>
                    </div>
                    <div class="col-md-3">
                        <strong>–¢–∏–ø:</strong><br>
                        <span id="modalImageType"></span>
                    </div>
                    <div class="col-md-3">
                        <strong>–î–µ–π—Å—Ç–≤–∏—è:</strong><br>
                        <a id="modalDownloadBtn" href="" class="btn btn-sm btn-success" download>
                            üì• –°–∫–∞—á–∞—Ç—å
                        </a>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                <a id="modalViewBtn" href="" class="btn btn-primary" target="_blank">–û—Ç–∫—Ä—ã—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ</a>
            </div>
        </div>
    </div>
</div>

<!-- ========================================================================
     JAVASCRIPT –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø–ú–ò
     –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
     ======================================================================== -->
<script>
/**
 * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
 * 
 * –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
 * - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
 * - –ì—Ä—É–ø–ø–æ–≤–æ–π –≤—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ —á–µ–∫–±–æ–∫—Å—ã
 * - –ì—Ä—É–ø–ø–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
 * - –í–∏–∑—É–∞–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
 */
document.addEventListener('DOMContentLoaded', function() {
    // ========================================================
    // –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨ –ö–û–ü–ò–†–û–í–ê–ù–ò–Ø –°–°–´–õ–û–ö
    // ========================================================
    const copyButtons = document.querySelectorAll('.copy-btn');
    
    copyButtons.forEach(button => {
        button.addEventListener('click', function() {
            const url = this.getAttribute('data-url');
            
            navigator.clipboard.writeText(url).then(() => {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏
                showTemporaryAlert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'info', 3000);
                
                const originalText = this.textContent;
                this.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                this.classList.remove('btn-outline-primary');
                this.classList.add('btn-success');
                
                setTimeout(() => {
                    this.textContent = originalText;
                    this.classList.remove('btn-success');
                    this.classList.add('btn-outline-primary');
                }, 2000);
            });
        });
    });
    
    // ========================================================
    // –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨ –ì–†–£–ü–ü–û–í–û–ì–û –í–´–ë–û–†–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô
    // ========================================================
    const selectAllCheckbox = document.getElementById('selectAll');
    const imageCheckboxes = document.querySelectorAll('.image-checkbox');
    const bulkActions = document.getElementById('bulkActions');
    const selectedCount = document.getElementById('selectedCount');
    const deleteSelectedBtn = document.getElementById('deleteSelected');
    const downloadSelectedBtn = document.getElementById('downloadSelected');
    const shareSelectedBtn = document.getElementById('shareSelected');
    const clearSelectionBtn = document.getElementById('clearSelection');
    
    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function updateSelectionState() {
        const checkedBoxes = document.querySelectorAll('.image-checkbox:checked');
        const count = checkedBoxes.length;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        selectedCount.textContent = `–í—ã–±—Ä–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${count}`;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        if (count > 0) {
            bulkActions.style.display = 'block';
            deleteSelectedBtn.disabled = false;
            deleteSelectedBtn.classList.remove('btn-outline-danger');
            deleteSelectedBtn.classList.add('btn-danger');
            downloadSelectedBtn.disabled = false;
            downloadSelectedBtn.classList.remove('btn-outline-success');
            downloadSelectedBtn.classList.add('btn-success');
            shareSelectedBtn.disabled = false;
            shareSelectedBtn.classList.remove('btn-outline-info');
            shareSelectedBtn.classList.add('btn-info');
        } else {
            bulkActions.style.display = 'none';
            deleteSelectedBtn.disabled = true;
            deleteSelectedBtn.classList.remove('btn-danger');
            deleteSelectedBtn.classList.add('btn-outline-danger');
            downloadSelectedBtn.disabled = true;
            downloadSelectedBtn.classList.remove('btn-success');
            downloadSelectedBtn.classList.add('btn-outline-success');
            shareSelectedBtn.disabled = true;
            shareSelectedBtn.classList.remove('btn-info');
            shareSelectedBtn.classList.add('btn-outline-info');
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–∞ "–í—ã–±—Ä–∞—Ç—å –≤—Å–µ"
        if (count === 0) {
            selectAllCheckbox.indeterminate = false;
            selectAllCheckbox.checked = false;
        } else if (count === imageCheckboxes.length) {
            selectAllCheckbox.indeterminate = false;
            selectAllCheckbox.checked = true;
        } else {
            selectAllCheckbox.indeterminate = true;
        }
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —á–µ–∫–±–æ–∫—Å–∞ "–í—ã–±—Ä–∞—Ç—å –≤—Å–µ"
    selectAllCheckbox.addEventListener('change', function() {
        const isChecked = this.checked;
        imageCheckboxes.forEach(checkbox => {
            checkbox.checked = isChecked;
        });
        updateSelectionState();
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —á–µ–∫–±–æ–∫—Å–æ–≤
    imageCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', updateSelectionState);
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—Ç–º–µ–Ω–∏—Ç—å –≤—ã–±–æ—Ä"
    clearSelectionBtn.addEventListener('click', function() {
        imageCheckboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
        selectAllCheckbox.checked = false;
        updateSelectionState();
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ"
    deleteSelectedBtn.addEventListener('click', function() {
        const checkedBoxes = document.querySelectorAll('.image-checkbox:checked');
        const imageIds = Array.from(checkedBoxes).map(cb => cb.value);
        const filenames = Array.from(checkedBoxes).map(cb => cb.getAttribute('data-filename'));
        
        if (imageIds.length === 0) return;
        
        const confirmMessage = `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å ${imageIds.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π?\n\n–§–∞–π–ª—ã:\n${filenames.join('\n')}`;
        
        if (confirm(confirmMessage)) {
            // –°–æ–∑–¥–∞–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = '{{ url_for("delete_multiple_images") }}';
            
            // –î–æ–±–∞–≤–ª—è–µ–º CSRF —Ç–æ–∫–µ–Ω –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
            {% if csrf_token %}
            const csrfInput = document.createElement('input');
            csrfInput.type = 'hidden';
            csrfInput.name = 'csrf_token';
            csrfInput.value = '{{ csrf_token() }}';
            form.appendChild(csrfInput);
            {% endif %}
            
            // –î–æ–±–∞–≤–ª—è–µ–º ID –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            imageIds.forEach(id => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'image_ids';
                input.value = id;
                form.appendChild(input);
            });
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É
            document.body.appendChild(form);
            form.submit();
        }
    });
    
    // ========================================================
    // –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨ –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê
    // ========================================================
    const imageModal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const modalImageName = document.getElementById('modalImageName');
    const modalImageSize = document.getElementById('modalImageSize');
    const modalImageType = document.getElementById('modalImageType');
    const modalDownloadBtn = document.getElementById('modalDownloadBtn');
    const modalViewBtn = document.getElementById('modalViewBtn');
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –º–∏–Ω–∏–∞—Ç—é—Ä–∞–º
    document.querySelectorAll('.image-thumbnail').forEach(thumbnail => {
        thumbnail.addEventListener('click', function() {
            const imageUrl = this.getAttribute('data-image-url');
            const imageName = this.getAttribute('data-image-name');
            const imageSize = this.getAttribute('data-image-size');
            const imageType = this.getAttribute('data-image-type');
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–∞–Ω–Ω—ã–º–∏
            modalImage.src = imageUrl;
            modalImage.alt = imageName;
            modalImageName.textContent = imageName;
            modalImageSize.textContent = imageSize;
            modalImageType.textContent = imageType;
            modalDownloadBtn.href = imageUrl.replace('/get_image/', '/download_image/');
            modalViewBtn.href = imageUrl;
        });
    });
    
    // ========================================================
    // –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨ –ì–†–£–ü–ü–û–í–û–ì–û –°–ö–ê–ß–ò–í–ê–ù–ò–Ø
    // ========================================================
    downloadSelectedBtn.addEventListener('click', function() {
        const checkedBoxes = document.querySelectorAll('.image-checkbox:checked');
        const imageIds = Array.from(checkedBoxes).map(cb => cb.value);
        const filenames = Array.from(checkedBoxes).map(cb => cb.getAttribute('data-filename'));
        
        if (imageIds.length === 0) return;
        
        // –°–æ–∑–¥–∞–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '{{ url_for("download_multiple_images") }}';
        
        // –î–æ–±–∞–≤–ª—è–µ–º CSRF —Ç–æ–∫–µ–Ω –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
        {% if csrf_token %}
        const csrfInput = document.createElement('input');
        csrfInput.type = 'hidden';
        csrfInput.name = 'csrf_token';
        csrfInput.value = '{{ csrf_token() }}';
        form.appendChild(csrfInput);
        {% endif %}
        
        // –î–æ–±–∞–≤–ª—è–µ–º ID –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
        imageIds.forEach(id => {
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'image_ids';
            input.value = id;
            form.appendChild(input);
        });
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É
         document.body.appendChild(form);
         form.submit();
     });
     
     // ========================================================
     // –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨ –°–û–ó–î–ê–ù–ò–Ø –°–°–´–õ–ö–ò –î–õ–Ø –°–ö–ê–ß–ò–í–ê–ù–ò–Ø
     // ========================================================
     shareSelectedBtn.addEventListener('click', function() {
         const checkedBoxes = document.querySelectorAll('.image-checkbox:checked');
         const imageIds = Array.from(checkedBoxes).map(cb => cb.value);
         const filenames = Array.from(checkedBoxes).map(cb => cb.getAttribute('data-filename'));
         
         if (imageIds.length === 0) return;
         
         // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
         const originalText = this.textContent;
         this.textContent = '‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏...';
         this.disabled = true;
         
         // –°–æ–∑–¥–∞–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–∫–∏
         fetch('{{ url_for("create_share_link") }}', {
             method: 'POST',
             headers: {
                 'Content-Type': 'application/json',
                 {% if csrf_token %}
                 'X-CSRFToken': '{{ csrf_token() }}'
                 {% endif %}
             },
             body: JSON.stringify({
                 image_ids: imageIds
             })
         })
         .then(response => response.json())
         .then(data => {
             if (data.success) {
                 // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Å—Å—ã–ª–∫–æ–π
                 showShareLinkModal(data.share_url, data.expires_at, filenames.length);
             } else {
                 alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Å—ã–ª–∫–∏: ' + (data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
             }
         })
         .catch(error => {
             console.error('Error:', error);
             alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Å—ã–ª–∫–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è');
         })
         .finally(() => {
             // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
             this.textContent = originalText;
             this.disabled = false;
         });
     });
     
     // ========================================================
     // –§–£–ù–ö–¶–ò–Ø –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê –° –°–°–´–õ–ö–û–ô
     // ========================================================
     function showShareLinkModal(shareUrl, expiresAt, fileCount) {
         // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
         const modalHtml = `
             <div class="modal fade" id="shareLinkModal" tabindex="-1" aria-hidden="true">
                 <div class="modal-dialog modal-lg">
                     <div class="modal-content">
                         <div class="modal-header">
                             <h5 class="modal-title">üîó –°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è</h5>
                             <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                         </div>
                         <div class="modal-body">
                             <div class="alert alert-info">
                                 <strong>üìÅ –§–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:</strong> ${fileCount}<br>
                                 <strong>‚è∞ –°—Å—ã–ª–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –¥–æ:</strong> ${new Date(expiresAt).toLocaleString('ru-RU')}
                             </div>
                             
                             <div class="mb-3">
                                 <label class="form-label"><strong>–°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:</strong></label>
                                 <div class="input-group">
                                     <input type="text" class="form-control" id="shareUrlInput" value="${shareUrl}" readonly>
                                     <button class="btn btn-outline-primary" type="button" id="copyShareUrl">
                                         üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                                     </button>
                                 </div>
                             </div>
                             
                             <div class="alert alert-warning">
                                 <strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong>
                                 <ul class="mb-0">
                                     <li>–°—Å—ã–ª–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞</li>
                                     <li>–õ—é–±–æ–π, —É –∫–æ–≥–æ –µ—Å—Ç—å —ç—Ç–∞ —Å—Å—ã–ª–∫–∞, —Å–º–æ–∂–µ—Ç —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª—ã</li>
                                     <li>–ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ —Å—Å—ã–ª–∫—É –Ω–µ–∑–Ω–∞–∫–æ–º—ã–º –ª—é–¥—è–º</li>
                                 </ul>
                             </div>
                         </div>
                         <div class="modal-footer">
                             <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                             <a href="${shareUrl}" class="btn btn-primary" target="_blank">üîó –û—Ç–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É</a>
                         </div>
                     </div>
                 </div>
             </div>
         `;
         
         // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ—Å–ª–∏ –µ—Å—Ç—å
         const existingModal = document.getElementById('shareLinkModal');
         if (existingModal) {
             existingModal.remove();
         }
         
         // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
         document.body.insertAdjacentHTML('beforeend', modalHtml);
         
         // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
         const modal = new bootstrap.Modal(document.getElementById('shareLinkModal'));
         modal.show();
         
         // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
         document.getElementById('copyShareUrl').addEventListener('click', function() {
             const input = document.getElementById('shareUrlInput');
             input.select();
             navigator.clipboard.writeText(input.value).then(() => {
                 // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏
                  showTemporaryAlert('–°—Å—ã–ª–∫–∞ –¥–ª—è –æ–±—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'info', 3000);
                 
                 const originalText = this.textContent;
                 this.textContent = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                 this.classList.add('btn-success');
                 this.classList.remove('btn-outline-primary');
                 
                 setTimeout(() => {
                     this.textContent = originalText;
                     this.classList.remove('btn-success');
                     this.classList.add('btn-outline-primary');
                 }, 2000);
             });
         });
         
         // –£–¥–∞–ª—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è
         document.getElementById('shareLinkModal').addEventListener('hidden.bs.modal', function() {
             this.remove();
         });
     }
 });
</script>
{% endblock %}